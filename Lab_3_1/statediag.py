# -*- coding: utf-8 -*-
"""Untitled4.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/112f1rkUB8q9a2pkHSQ1Tao_cDEmQ-I0T
"""

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ diagrams –≤ Google Colab
!pip install diagrams

from diagrams import Diagram, Cluster, Edge
from diagrams.onprem.client import User
from diagrams.generic.compute import Rack
from diagrams.generic.device import Mobile
from diagrams.onprem.compute import Server
from diagrams.generic.storage import Storage
from diagrams.generic.network import Firewall
from diagrams.onprem.network import Internet

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —É–∑–ª–æ–≤ –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏–π Fog-—É–∑–ª–∞
from diagrams import Node

class StateNode(Node):
    _provider = "custom"
    _icon_dir = None
    font_size = "16"

    def __init__(self, label, **kwargs):
        super().__init__(label, **kwargs)

# –°–æ–∑–¥–∞–µ–º State-–¥–∏–∞–≥—Ä–∞–º–º—É –¥–ª—è Fog-—É–∑–ª–∞
with Diagram("State-–¥–∏–∞–≥—Ä–∞–º–º–∞ Fog-—É–∑–ª–∞ –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ '–ö—Ä–∞–π-–¢—É–º–∞–Ω-–û–±–ª–∞–∫–æ'",
             show=False,
             direction="LR",
             graph_attr={"splines": "ortho", "ranksep": "2", "nodesep": "2"}):

    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è Fog-—É–∑–ª–∞
    standby = StateNode("–†–µ–∂–∏–º –æ–∂–∏–¥–∞–Ω–∏—è\n(Fog-—É–∑–µ–ª –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ)")
    receiving = StateNode("–ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏\n(–ó–∞–ø—Ä–æ—Å –æ—Ç –∫—Ä–∞–µ–≤–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞)")
    processing = StateNode("–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö\n(–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π)")
    sending = StateNode("–ü–µ—Ä–µ–¥–∞—á–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞\n(–û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ –∫—Ä–∞–π –∏–ª–∏ –≤ –æ–±–ª–∞–∫–æ)")
    overload = StateNode("–ü–µ—Ä–µ–≥—Ä—É–∑–∫–∞/–û–∂–∏–¥–∞–Ω–∏–µ\n(–û—á–µ—Ä–µ–¥—å –∏–ª–∏ –ø–µ—Ä–µ–¥–∞—á–∞ –≤ –æ–±–ª–∞–∫–æ)")
    recovery = StateNode("–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ\n(–í–æ–∑–≤—Ä–∞—Ç –≤ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º)")

    # –°–æ–∑–¥–∞–µ–º —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏
    standby >> Edge(color="green", label="–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞") >> receiving
    receiving >> Edge(color="blue", label="–ù–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏") >> processing
    processing >> Edge(color="orange", label="–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏") >> sending
    sending >> Edge(color="green", label="–£—Å–ø–µ—à–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞") >> standby

    # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã
    processing >> Edge(color="red", style="dashed", label="–ü–µ—Ä–µ–≥—Ä—É–∑–∫–∞ CPU/RAM") >> overload
    receiving >> Edge(color="red", style="dashed", label="–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤") >> overload
    overload >> Edge(color="blue", label="–ü–µ—Ä–µ–¥–∞—á–∞ –≤ –æ–±–ª–∞–∫–æ") >> sending
    overload >> Edge(color="green", label="–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ") >> recovery
    recovery >> Edge(color="green", label="–ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ") >> standby

    # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞—Ç–Ω—ã–µ —Å–≤—è–∑–∏
    sending >> Edge(color="red", style="dotted", label="–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏") >> overload
    overload >> Edge(color="red", style="dotted", label="–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞") >> overload  # self-loop

# –¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–¥–∏–º –æ–±—â—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å–∏—Å—Ç–µ–º—ã
with Diagram("–¢—Ä–µ—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ '–ö—Ä–∞–π-–¢—É–º–∞–Ω-–û–±–ª–∞–∫–æ'\n(5 –∫—Ä–∞–µ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤, 3 Fog-—É–∑–ª–∞, 2 –æ–±–ª–∞—á–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞)",
             show=False,
             direction="TB"):

    # –û–±–ª–∞—á–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å
    cloud_label = "–û–±–ª–∞—á–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å\n(2 —Å–µ—Ä–≤–µ—Ä–∞)"
    with Cluster(cloud_label):
        cloud1 = Server("–û–±–ª–∞—á–Ω—ã–π —Å–µ—Ä–≤–µ—Ä 1")
        cloud2 = Server("–û–±–ª–∞—á–Ω—ã–π —Å–µ—Ä–≤–µ—Ä 2")
        cloud_storage = Storage("–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ")

        cloud_group = [cloud1, cloud2, cloud_storage]
        cloud1 - cloud2
        cloud1 >> cloud_storage
        cloud2 >> cloud_storage

    # Fog-—É—Ä–æ–≤–µ–Ω—å
    fog_label = "Fog-—É—Ä–æ–≤–µ–Ω—å\n(3 —É–∑–ª–∞)"
    with Cluster(fog_label):
        fog1 = Server("Fog-—É–∑–µ–ª 1")
        fog2 = Server("Fog-—É–∑–µ–ª 2")
        fog3 = Server("Fog-—É–∑–µ–ª 3")

        fog_group = [fog1, fog2, fog3]
        fog1 - fog2 - fog3

    # –ö—Ä–∞–µ–≤–æ–π —É—Ä–æ–≤–µ–Ω—å
    edge_label = "–ö—Ä–∞–µ–≤–æ–π —É—Ä–æ–≤–µ–Ω—å\n(5 —É—Å—Ç—Ä–æ–π—Å—Ç–≤)"
    with Cluster(edge_label):
        edge1 = Mobile("–ö—Ä–∞–µ–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ 1")
        edge2 = Mobile("–ö—Ä–∞–µ–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ 2")
        edge3 = Mobile("–ö—Ä–∞–µ–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ 3")
        edge4 = Mobile("–ö—Ä–∞–µ–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ 4")
        edge5 = Mobile("–ö—Ä–∞–µ–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ 5")

        edge_group = [edge1, edge2, edge3, edge4, edge5]

    # –°–æ–µ–¥–∏–Ω–µ–Ω–∏—è –º–µ–∂–¥—É —É—Ä–æ–≤–Ω—è–º–∏
    internet = Internet("–°–µ—Ç—å")

    # –ö—Ä–∞–π -> Fog
    for edge in edge_group:
        edge >> Edge(color="blue", label="–î–∞–Ω–Ω—ã–µ —Å –¥–∞—Ç—á–∏–∫–æ–≤") >> internet

    internet >> Edge(color="blue", label="–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏") >> fog_group

    # Fog -> –û–±–ª–∞–∫–æ
    for fog in fog_group:
        fog >> Edge(color="orange", label="–ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ", style="dashed") >> cloud_group

    # –û–±–ª–∞–∫–æ -> Fog (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)
    cloud1 >> Edge(color="green", label="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è", style="dotted") >> fog_group

    # –ü—Ä—è–º—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ö—Ä–∞–π-–û–±–ª–∞–∫–æ (–¥–ª—è —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤)
    edge1 >> Edge(color="red", label="–≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ", style="dotted") >> cloud2

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ —Ä–∞–±–æ—Ç—É –æ–¥–Ω–æ–≥–æ Fog-—É–∑–ª–∞
with Diagram("–¶–∏–∫–ª —Ä–∞–±–æ—Ç—ã Fog-—É–∑–ª–∞ –≤ —Å–∏—Å—Ç–µ–º–µ",
             show=False,
             direction="TB"):

    # –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π Fog-—É–∑–µ–ª
    fog_node = Server("Fog-—É–∑–µ–ª\n(–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)")

    # –°–æ—Å—Ç–æ—è–Ω–∏—è –≤–æ–∫—Ä—É–≥ —É–∑–ª–∞
    standby_state = StateNode("‚ë† –û–∂–∏–¥–∞–Ω–∏–µ\n(–Ω–∏–∑–∫–æ–µ —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ)")
    receive_state = StateNode("‚ë° –ü–æ–ª—É—á–µ–Ω–∏–µ\n(–ø—Ä–∏–µ–º –¥–∞–Ω–Ω—ã—Ö —Å –∫—Ä–∞—è)")
    process_state = StateNode("‚ë¢ –û–±—Ä–∞–±–æ—Ç–∫–∞\n(–ª–æ–∫–∞–ª—å–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è)")
    send_state = StateNode("‚ë£ –ü–µ—Ä–µ–¥–∞—á–∞\n(—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞–≤–µ—Ä—Ö)")
    overload_state = StateNode("‚ë§ –ü–µ—Ä–µ–≥—Ä—É–∑–∫–∞\n(–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏)")

    # –†–∞—Å–ø–æ–ª–∞–≥–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ –∫—Ä—É–≥—É
    standby_state - Edge(style="invis") - receive_state
    receive_state - Edge(style="invis") - process_state
    process_state - Edge(style="invis") - send_state
    send_state - Edge(style="invis") - overload_state
    overload_state - Edge(style="invis") - standby_state

    # –°–≤—è–∑—å —É–∑–ª–∞ —Å —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏
    fog_node >> Edge(color="blue", label="–ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤") >> standby_state
    fog_node >> Edge(color="blue", label="–ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤") >> receive_state
    fog_node >> Edge(color="blue", label="–ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤") >> process_state
    fog_node >> Edge(color="blue", label="–ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤") >> send_state
    fog_node >> Edge(color="blue", label="–ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤") >> overload_state

# –î–∏–∞–≥—Ä–∞–º–º–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏
with Diagram("–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏",
             show=False,
             direction="LR"):

    # –ö—Ä–∞–µ–≤—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
    with Cluster("5 –∫—Ä–∞–µ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤", graph_attr={"bgcolor": "lightblue"}):
        edges = [Mobile(f"–£—Å—Ç—Ä-–≤–æ {i+1}") for i in range(5)]

    # Fog-—É–∑–ª—ã
    with Cluster("3 Fog-—É–∑–ª–∞", graph_attr={"bgcolor": "lightgreen"}):
        fog_nodes = [Server(f"Fog {i+1}") for i in range(3)]

    # –û–±–ª–∞—á–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã
    with Cluster("2 –æ–±–ª–∞—á–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞", graph_attr={"bgcolor": "lightyellow"}):
        clouds = [Server(f"–û–±–ª–∞–∫–æ {i+1}") for i in range(2)]
        storage = Storage("–•—Ä–∞–Ω–∏–ª–∏—â–µ")
        clouds[0] - clouds[1]
        clouds[0] >> storage
        clouds[1] >> storage

    # –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 5->3)
    # –ö–∞–∂–¥—ã–π Fog-—É–∑–µ–ª –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç 1-2 —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
    edges[0] >> fog_nodes[0]
    edges[1] >> fog_nodes[0]
    edges[2] >> fog_nodes[1]
    edges[3] >> fog_nodes[1]
    edges[4] >> fog_nodes[2]

    # Fog-—É–∑–ª—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ –æ–±–æ–∏–º –æ–±–ª–∞—á–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–∞–º
    for fog in fog_nodes:
        fog >> clouds[0]
        fog >> clouds[1]

    # –†–µ–∑–µ—Ä–≤–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
    edges[0] >> Edge(style="dotted", color="gray") >> fog_nodes[2]  # —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ
    edges[4] >> Edge(style="dotted", color="gray") >> fog_nodes[0]  # —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ

print("=" * 70)
print("–î–ò–ê–ì–†–ê–ú–ú–´ –°–û–ó–î–ê–ù–´ –£–°–ü–ï–®–ù–û!")
print("=" * 70)
print("\nüìä –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã:")
print("   ‚îî‚îÄ‚îÄ 5 –∫—Ä–∞–µ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ ‚Üí 3 Fog-—É–∑–ª–∞ ‚Üí 2 –æ–±–ª–∞—á–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞")
print("\n‚öñÔ∏è –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏:")
print("   ‚îú‚îÄ‚îÄ –ö–∞–∂–¥—ã–π Fog-—É–∑–µ–ª –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç: 1-2 –∫—Ä–∞–µ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞")
print("   ‚îú‚îÄ‚îÄ –û–±—â–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –º–µ–∂–¥—É 3 Fog-—É–∑–ª–∞–º–∏")
print("   ‚îî‚îÄ‚îÄ –û–±–ª–∞—á–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã –¥—É–±–ª–∏—Ä—É—é—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏")
print("\nüîÑ –°–æ—Å—Ç–æ—è–Ω–∏—è Fog-—É–∑–ª–∞:")
print("   1. –û–∂–∏–¥–∞–Ω–∏–µ - –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–∞–±–æ—Ç–µ")
print("   2. –ü–æ–ª—É—á–µ–Ω–∏–µ - –ø—Ä–∏–µ–º –¥–∞–Ω–Ω—ã—Ö —Å –∫—Ä–∞—è")
print("   3. –û–±—Ä–∞–±–æ—Ç–∫–∞ - –ª–æ–∫–∞–ª—å–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è")
print("   4. –ü–µ—Ä–µ–¥–∞—á–∞ - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤")
print("   5. –ü–µ—Ä–µ–≥—Ä—É–∑–∫–∞ - –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞/–æ—á–µ—Ä–µ–¥—å")
print("\n‚úÖ –î–∏–∞–≥—Ä–∞–º–º—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª—ã:")
print("   - architecture.png")
print("   - state_diagram.png")
print("   - fog_cycle.png")
print("   - load_distribution.png")